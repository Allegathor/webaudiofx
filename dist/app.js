!function(e){function t(t){for(var i,r,n=t[0],c=t[1],l=t[2],u=0,h=[];u<n.length;u++)r=n[u],o[r]&&h.push(o[r][0]),o[r]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(e[i]=c[i]);for(d&&d(t);h.length;)h.shift()();return s.push.apply(s,l||[]),a()}function a(){for(var e,t=0;t<s.length;t++){for(var a=s[t],i=!0,n=1;n<a.length;n++){var c=a[n];0!==o[c]&&(i=!1)}i&&(s.splice(t--,1),e=r(r.s=a[0]))}return e}var i={},o={1:0},s=[];function r(t){if(i[t])return i[t].exports;var a=i[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=i,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:a})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="dist/";var n=window.webpackJsonp=window.webpackJsonp||[],c=n.push.bind(n);n.push=t,n=n.slice();for(var l=0;l<n.length;l++)t(n[l]);var d=c;s.push([5,0]),a()}({5:function(e,t,a){"use strict";var i,o=a(4),s=a(3),r=(i=s)&&i.__esModule?i:{default:i};function n(e){this.el=e;var t=this.el,a=document.getElementById(t.dataset.label),i=null,s=function(){var e,o=parseFloat(t.dataset.minValue),s=parseFloat(t.dataset.maxValue),r=a.dataset.units||"",n=Math.abs(o-s),c=i.rotation/300+.5,l=parseFloat(t.dataset.fixed)||1;c<=0&&(c=0),c>=1&&(c=1),e=(c*parseFloat(n)+o).toFixed(l),a&&(a.textContent=e+r),t.dataset.value=e},n=function(){var e=parseFloat(t.dataset.value),a=parseFloat(t.dataset.minValue),i=parseFloat(t.dataset.maxValue);return 300*((e-a)/Math.abs(a-i)-.5)};this.init=function(){o.TweenLite.set(t,{rotation:n()}),r.default.create(t,{type:"rotation",throwProps:!1,edgeResistance:.85,onDrag:s,bounds:{minRotation:-150,maxRotation:150}}),i=r.default.get(t)},this.update=function(e,t){this.el.dataset[e]=t;var a=document.getElementById(this.el.dataset.label),i=a.dataset.units||"";a.textContent=t+i,o.TweenLite.set(this.el,{rotation:n()})}}var c=[];Array.prototype.forEach.call(document.querySelectorAll(".plugin"),function(e){var t=new n(e);t.init(),c.push(t)});var l=new(window.AudioContext||window.webkitAudioContext);function d(e,t){return e.classList?e.classList.contains(t):!!e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))}function u(e,t){this.context=e,this.canvasContext=t,this.amp={level:1,attack:0,release:1.5},this.pitch={frequency:150,attack:0,release:1.5},this.filter={gain:0,frequency:150,resonance:1.5},this.delay={feedback:0,time:0},this.compressor={threshold:-50,knee:40,ratio:12,attack:0,release:.25},this.distortion={gain:0,damage:0}}u.prototype.loadPluginValues=function(){this.amp.level=parseFloat(document.querySelector("#mod-1").dataset.value),this.amp.attack=parseFloat(document.querySelector("#mod-2").dataset.value),this.amp.release=parseFloat(document.querySelector("#mod-3").dataset.value),this.pitch.frequency=parseFloat(document.querySelector("#mod-4").dataset.value),this.pitch.attack=parseFloat(document.querySelector("#mod-5").dataset.value),this.pitch.release=parseFloat(document.querySelector("#mod-6").dataset.value),this.filter.gain=parseFloat(document.querySelector("#mod-7").dataset.value),this.filter.frequency=parseFloat(document.querySelector("#mod-8").dataset.value),this.filter.resonance=parseFloat(document.querySelector("#mod-9").dataset.value),this.compressor.threshold=parseFloat(document.querySelector("#mod-10").dataset.value),this.compressor.knee=parseFloat(document.querySelector("#mod-11").dataset.value),this.compressor.ratio=parseFloat(document.querySelector("#mod-12").dataset.value),this.compressor.release=parseFloat(document.querySelector("#mod-15").dataset.value),this.delay.feedback=parseFloat(document.querySelector("#mod-16").dataset.value),this.delay.time=parseFloat(document.querySelector("#mod-17").dataset.value),this.distortion.gain=parseFloat(document.querySelector("#mod-18").dataset.value),this.distortion.damage=parseFloat(document.querySelector("#mod-19").dataset.value)},u.prototype.setup=function(){this.oscillatorNode=this.context.createOscillator(),this.gainNode=this.context.createGain(),this.filterNode=this.context.createBiquadFilter(),this.delayNode=this.context.createDelay(6),this.delayFeedback=this.context.createGain(),this.distortionNode=this.context.createWaveShaper(),this.distortionGain=this.context.createGain(),this.analyser=this.context.createAnalyser(),this.analyser.minDecibels=-90,this.analyser.maxDecibels=-10,this.analyser.smoothingTimeConstant=.85,this.compressorNode=this.context.createDynamicsCompressor(),this.oscillatorNode.connect(this.filterNode),this.filterNode.connect(this.distortionNode),this.distortionNode.connect(this.distortionGain),this.distortionGain.connect(this.gainNode),this.filterNode.connect(this.gainNode),this.delayNode.connect(this.delayFeedback),this.delayFeedback.connect(this.delayNode),this.gainNode.connect(this.compressorNode),this.compressorNode.connect(this.delayNode),this.compressorNode.connect(this.context.destination),this.compressorNode.connect(this.analyser),this.delayFeedback.connect(this.context.destination),this.delayFeedback.connect(this.analyser),this.gainNode.gain.setValueAtTime(0,this.context.currentTime),this.oscillatorNode.start(this.context.currentTime)},u.prototype.trigger=function(e){var t,a,i=document.querySelector("#kick-button");e&&e.key&&(a="active",(t=i).classList?t.classList.add(a):d(t,a)||(t.className+=" "+a),setTimeout(function(e,t){if(e.classList)e.classList.remove(t);else if(d(e,t)){var a=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(a," ")}}.bind(this,i,"active"),50)),this.loadPluginValues(),this.oscillatorNode.frequency.cancelScheduledValues(this.context.currentTime),this.gainNode.gain.cancelScheduledValues(this.context.currentTime),this.filterNode.gain.value=this.filter.gain,this.filterNode.frequency.value=this.filter.frequency,this.filterNode.Q.value=this.filter.resonance,this.delayNode.delayTime.value=this.delay.time,this.delayFeedback.gain.value=this.delay.feedback,this.distortionGain.gain.value=this.distortion.gain,this.distortionNode.curve=this.makeDistortionCurve(this.distortion.damage),this.compressorNode.threshold.value=this.compressor.threshold,this.compressorNode.knee.value=this.compressor.knee,this.compressorNode.ratio.value=this.compressor.ratio,this.compressorNode.attack.value=this.compressor.attack,this.compressorNode.release.value=this.compressor.release,this.gainNode.gain.setValueAtTime(0,this.context.currentTime),this.gainNode.gain.linearRampToValueAtTime(this.amp.level,this.context.currentTime+this.amp.attack),this.gainNode.gain.exponentialRampToValueAtTime(1e-4,this.context.currentTime+this.amp.attack+this.amp.release),this.gainNode.gain.setValueAtTime(0,this.context.currentTime+this.amp.attack+this.amp.release),this.oscillatorNode.frequency.setValueAtTime(1e-4,this.context.currentTime),this.oscillatorNode.frequency.linearRampToValueAtTime(this.pitch.frequency,this.context.currentTime+this.pitch.attack),this.oscillatorNode.frequency.exponentialRampToValueAtTime(1e-4,this.context.currentTime+this.pitch.attack+this.pitch.release),function(e){var t=m.width,a=m.height;e.fftSize=2048;var i=e.frequencyBinCount,o=new Uint8Array(i);!function s(){requestAnimationFrame(s),e.getByteTimeDomainData(o),p.fillStyle="rgb(240, 235, 216)",p.fillRect(0,0,t,a),p.lineWidth=2,p.strokeStyle="rgb(0, 0, 0)",p.beginPath();for(var r=1*t/i,n=0,c=0;c<i;c++){var l=o[c]/128,d=l*a/2;0===c?p.moveTo(n,d):p.lineTo(n,d),n+=r}p.lineTo(m.width,m.height/2),p.stroke()}()}(this.analyser)},u.prototype.makeDistortionCurve=function(e){for(var t,a="number"==typeof e?e:0,i=new Float32Array(44100),o=Math.PI/180,s=0;s<44100;++s)t=2*s/44100-1,i[s]=(3+a)*t*20*o/(Math.PI+a*Math.abs(t));return i};var h=document.getElementById("kick-button"),m=document.querySelector(".canvas"),p=m.getContext("2d");m.width=860,p.fillStyle="rgb(240, 235, 216)",p.fillRect(0,0,m.width,m.height);var f,y=new u(l);y.setup(),window.addEventListener("keypress",y.trigger.bind(y)),h.addEventListener("click",y.trigger.bind(y)),document.querySelector(".load-preset").addEventListener("click",function(e){if(!f){!function(e){var t=function(){a.open("GET",e,!0),a.send()},a=new XMLHttpRequest;a.onreadystatechange=function(){4==this.readyState&&(200==this.status?function(e){for(var t in e){var a=e[t];switch(t){case"amp":c[0].update("value",a[0]),c[1].update("value",a[1]),c[2].update("value",a[2]);break;case"pitch":c[3].update("value",a[0]),c[4].update("value",a[1]),c[5].update("value",a[2]);break;case"distortion":c[16].update("value",a[0]),c[17].update("value",a[1])}}}(f=JSON.parse(this.responseText)):(console.log("Trying to request data again"),setTimeout(t,6e3)))},t()}("https://gist.githubusercontent.com/Allegathor/cf54bbbc9138d35407d7d1733c381e34/raw/e38b9a08c2bd89f8b04669ac863d54367695f55f/preset.json")}})}});